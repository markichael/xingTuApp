## 总体架构
- 路由统一在 `HomeScreen`：根据入口状态显示对应编辑器或结果页
- 编辑器壳层 `EditorShell`：统一画布/顶部栏/底部分类；在壳层内根据工具切换控制面板
- 图片保存统一走 `SaveUtils`，成功后进入 `SaveResultScreen`
- 数据模型统一：`EditorCategory`（人像/滤镜/调节/更多）、`ToolItem`（工具项）、`EditorState`

## 功能版块与实现步骤
### 1. 导入照片 / 相机
- 保留已实现的单选导入与拍照流程（`rememberLauncherForActivityResult` + FileProvider）
- 新增“最近作品”网格在首页下方，点击进入结果页预览

### 2. AI修人像（已完成基础）
- 基线：RenderScript 美颜（磨皮/美白/红润/清晰）+ 预设
- 迭代：
  1) 接入 MediaPipe Face Mesh（人脸关键点）
  2) 实现几何变形（瘦脸瘦身/面部重塑）
  3) 形变使用三角网格/仿射变换，对应可视化滑条
  4) 性能：预览 1080p，保存原图，线程在 IO，UI Compose

### 3. 滤镜（已完成基础，继续扩充）
- 基线：ColorMatrix 滤镜（暖色/冷色/黑白/复古/青橙/粉调/绿野/增/降饱和）
- 迭代：
  1) LUT 支持（读取 `.cube` 或自定义表）
  2) 曲线滤镜（亮度/对比/色相/饱和/色阶）
  3) 强度滑条与并行预览（小图临时缓冲）

### 4. 拼图（已完成基础）
- 保留拖拽交换/模板/保存流程
- 迭代：边框/背景色/阴影/贴纸叠加；导出页跳首页已接入

### 5. 批量修图
- 批处理入口（多选图片）
- 处理队列：对每张执行所选预设（滤镜/美颜）
- 进度 UI：列表 + 进度条 + 错误收集；保存到相册并可选打包分享

### 6. 画质超清（超分）
- 方案 A：集成开源 ESRGAN/Real-ESRGAN 的 ncnn 移植（Android 端推理）
- 方案 B：MLKit Image Enhancement（若可用）或 GPU 上的锐化+去噪组合
- UI：强度滑条、目标尺寸选择（1.5x/2x）、耗时提示

### 7. 魔法消除 / 一键消除（物体移除）
- 前景选择：
  - 智能选择笔刷：语义分割（DeepLab/MLKit Segmentation）得到掩码
  - 手动涂抹：Compose 画布记录路径 → 掩码
- 消除算法：OpenCV `inpaint`（Telea/NS），支持半径与迭代参数
- 结果融合：边缘 feather + 局部色彩匹配

### 8. 智能抠图（主体分割）
- 模型：MLKit Selfie Segmentation 或 MediaPipe Selfie
- 输出：透明背景 PNG、替换背景（纯色/模糊/图片）
- UI：背景选择器 + 强度/羽化滑条

### 9. 贴纸 / 文字 / 特效（渐进增强）
- 贴纸：素材包 + 布局控制（拖拽缩放旋转）
- 文字：字体/大小/颜色/描边/阴影；路径变形（后续）
- 特效：粒子/光斑/光效叠加（BlendMode + 叠层）

### 10. 所有工具（工具集合页）
- 新建 `ToolsHubScreen`：卡片式展示全部工具入口与简述
- 支持搜索与最近使用；点击进入对应编辑器

## 技术依赖与集成
- 已用：Compose, RenderScript（美颜与滤镜）, Coil（预览）
- 拟引入：
  - MediaPipe（Face Mesh / Selfie Segmentation）
  - OpenCV（inpaint / 形态学 / 滤波）
  - ncnn + Real-ESRGAN（端侧超分）或替代方案
- 封装：为每个模型建立 `Processor`（如 `SuperResProcessor`、`InpaintProcessor`）

## 性能与稳定
- 双位图策略：预览小图，保存原图
- 统一线程：计算在 `Dispatchers.IO`；UI 主线程
- 内存：限制多图加载分辨率（预览<=1080），按需释放；监控日志

## UI/UX 规范
- 深色主题 + 亮绿主色（#CCFF00）；统一顶部栏与底部工具区高度
- 保存后进入结果页，支持首页与再修一张；最近作品横向列表
- 对比：长按画布显示原图；滑条下方显示功能说明

## 验证与测试
- 设备：小米 14 优先；验证黑屏/性能/内存
- 用例：每个工具的导入 → 预览 → 导出 → 结果页
- 崩溃与日志：统一 try-catch + Toast 提示 + Log 标签

## 里程碑（按实现复杂度）
1) 工具壳层完善、滤镜/LUT、批量修图基础
2) 魔法消除/智能抠图（语义分割+OpenCV）
3) 面部重塑（Face Mesh + 几何变形）、超分（ncnn集成）
4) 贴纸/文字/特效、工具集合页完善

请确认该计划，确认后我将按上述顺序逐步实现首页中的所有功能，并在每个阶段交付可运行的界面与验证。